
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    -webkit-tap-highlight-color: transparent;
  }
}

@layer components {
  .custom-scrollbar::-webkit-scrollbar {
    width: 4px;
  }
  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: #E2E8F0;
    border-radius: 10px;
  }
  
  .glass-card {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
  
  .math-visual {
    display: inline-block;
    vertical-align: middle;
  }

  /* --- Unified Table Styles for Editor & Viewers (Fixes Dark Mode Headers) --- */
  
  /* Target both the Editor (.wysiwyg-content) and Tailwind Typography (.prose) */
  .wysiwyg-content table, 
  .prose table { 
    width: 100%; 
    border-collapse: collapse; 
    margin: 0.5rem 0; 
  } 

  /* Cell Borders & Spacing */
  .wysiwyg-content th, .wysiwyg-content td,
  .prose th, .prose td { 
    border: 1px solid #cbd5e1; 
    padding: 0.5rem; 
    min-width: 30px; 
    color: inherit; 
  } 

  /* Dark Mode Borders */
  .dark .wysiwyg-content th, .dark .wysiwyg-content td,
  .dark .prose th, .dark .prose td { 
    border-color: #334155; 
  } 

  /* Header Styling (Light Mode) */
  .wysiwyg-content th,
  .prose th, .prose thead th { 
    background-color: #f8fafc; 
    font-weight: bold; 
    text-align: left; 
  } 

  /* Header Styling (Dark Mode) - CRITICAL FIX */
  .dark .wysiwyg-content th,
  .dark .prose th, .dark .prose thead th { 
    background-color: #1e293b !important; /* Slate 800 */
    color: #f1f5f9 !important; /* Slate 100 */
    border-color: #334155;
  } 

  /* Body Cell Styling (Dark Mode) */
  .dark .wysiwyg-content td,
  .dark .prose td { 
    background-color: transparent; 
    color: #f1f5f9; 
  }

  /* Wysiwyg Specific Lists & Quotes (Replicating Editor Styles Globally) */
  .wysiwyg-content:empty:before { content: attr(data-placeholder); color: #94a3b8; font-style: italic; } 
  .dark .wysiwyg-content:empty:before { color: #64748b; } 
  .wysiwyg-content ul { list-style-type: disc; padding-left: 1.5rem; } 
  .wysiwyg-content ol { list-style-type: decimal; padding-left: 1.5rem; } 
  .wysiwyg-content blockquote { border-left: 3px solid #cbd5e1; padding-left: 1rem; color: #64748b; font-style: italic; } 
  .dark .wysiwyg-content blockquote { border-color: #475569; color: #94a3b8; } 
  .dark .wysiwyg-content { color: #f1f5f9; }

  /* Fix Image Alignment: Ensure images respect parent text-align (e.g. Center, Right) */
  .wysiwyg-content img, 
  .prose img {
    display: inline-block;
  }

  /* --- Aggressive Dark Mode Text Visibility Fixes --- */
  
  /* 1. For Options: Force ALL content to inherit color. This is safe as options are usually simple text. */
  .dark .option-content, 
  .dark .option-content * {
      color: inherit !important;
      background-color: transparent !important;
  }

  /* 2. For General Content (Prose/Editor): Target text containers to strip black colors, but respect structure */
  .dark .wysiwyg-content :is(span, p, div, font, b, i, u, strong, em, h1, h2, h3, h4, h5, h6, li, blockquote, pre),
  .dark .prose :is(span, p, div, font, b, i, u, strong, em, h1, h2, h3, h4, h5, h6, li, blockquote, pre) {
      color: inherit !important;
      background-color: transparent !important;
  }

  /* 3. Catch-all for explicit black styles that might be on other elements */
  .dark .wysiwyg-content *[style*="color: black"], 
  .dark .wysiwyg-content *[style*="color: rgb(0, 0, 0)"], 
  .dark .wysiwyg-content *[style*="color: #000000"],
  .dark .wysiwyg-content *[style*="color:rgb(0,0,0)"],
  .dark .prose *[style*="color: black"], 
  .dark .prose *[style*="color: rgb(0, 0, 0)"], 
  .dark .prose *[style*="color: #000000"],
  .dark .prose *[style*="color:rgb(0,0,0)"] {
      color: inherit !important;
  }

  /* --- Text Normalization (Smarter Approach) --- */
  
  /* 1. Reset Font Size & Line Height ONLY for generic containers (p, div, span, font, li) 
     This fixes copy-paste issues from Word/PDF without breaking Headings (h1-h6) or Alignment */
  .prose:not(.prose-sm) :is(p, div, span, font, li):not([class*="text-"]), 
  .wysiwyg-content :is(p, div, span, font, li):not([class*="text-"]) {
      font-size: 1rem !important;
      line-height: 1.75 !important;
      /* Removed text-align: left !important to respect user alignment */
  }

  /* 2. Small Prose (Result/Archive View) - Force 14px */
  .prose.prose-sm :is(p, div, span, font, li):not([class*="text-"]) {
      font-size: 0.875rem !important;
      line-height: 1.5 !important;
  }

  /* 3. Options - Force 14px */
  .option-content :is(p, div, span, font, li):not([class*="text-"]) {
      font-size: 0.875rem !important;
      line-height: 1.5 !important;
  }

  /* 4. Fix specific "font-size" inline styles from Word/GDocs that are too small/large 
     Only targets inline styles, preserving class-based sizing */
  .prose [style*="font-size"], .wysiwyg-content [style*="font-size"] {
      font-size: 1em !important; 
  }

  /* Exceptions for Superscript/Subscript */
  .prose sup, .prose sub, .wysiwyg-content sup, .wysiwyg-content sub { 
      font-size: 75% !important; 
      line-height: 0 !important; 
      vertical-align: baseline !important;
      position: relative !important;
  }
  .prose sup, .wysiwyg-content sup { top: -0.5em !important; }
  .prose sub, .wysiwyg-content sub { bottom: -0.25em !important; }
}
